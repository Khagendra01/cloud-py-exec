name: "python_cloud_run"
description: "Python execution optimized for Cloud Run"

mode: ONCE
hostname: "python-jail"
time_limit: 30
daemon: false

# Cloud Run-compatible: avoid user namespaces/cap manipulations
clone_newnet: false
clone_newuser: false
clone_newns: false
clone_newpid: false
clone_newipc: false
clone_newuts: false
clone_newcgroup: false

keep_caps: false

# Resource limits
rlimit_as: 256
rlimit_cpu: 30
rlimit_fsize: 16
rlimit_nofile: 64
rlimit_nproc: 32

mount {
  src: "tmpfs"
  dst: "/"
  fstype: "tmpfs"
  options: "size=64M"
  rw: false
}

mount {
  src: "/lib"
  dst: "/lib"
  is_bind: true
  rw: false
}

mount {
  src: "/lib64"
  dst: "/lib64"
  is_bind: true
  rw: false
}

mount {
  src: "/usr/lib"
  dst: "/usr/lib"
  is_bind: true
  rw: false
}

mount {
  src: "/usr/local/bin/python3"
  dst: "/usr/bin/python3"
  is_bind: true
  rw: false
}

mount {
  src: "/usr/lib/python3"
  dst: "/usr/lib/python3"
  is_bind: true
  rw: false
}

mount {
  src: "tmpfs"
  dst: "/tmp"
  fstype: "tmpfs"
  options: "size=32M"
  rw: true
}

mount {
  src: "/dev/null"
  dst: "/dev/null"
  is_bind: true
  rw: false
}

mount {
  src: "/dev/urandom"
  dst: "/dev/urandom"
  is_bind: true
  rw: false
}

mount {
  src: "proc"
  dst: "/proc"
  fstype: "proc"
  rw: false
}


